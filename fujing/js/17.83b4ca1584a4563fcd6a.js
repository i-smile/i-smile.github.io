(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"544":function(e,t,n){"use strict";function isEmpty(e){return void 0===e||""===e||null===e||"{}"===JSON.stringify(e)}function valiIdCard(e){return!!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e)}function valiPhone(e){if(!e)return!1;return/^((\d{3,4}-)?\d{7,8})$|^1(3|4|5|7|8)\d{9}$/.test(e)}function valiCarNumber(e){return/^桂[林]?[0-9A-Z]{5,6}$/.test(e)}n.d(t,"a",(function(){return isEmpty})),n.d(t,"c",(function(){return valiIdCard})),n.d(t,"d",(function(){return valiPhone})),n.d(t,"b",(function(){return valiCarNumber}))},"599":function(e,t,n){"use strict";n.d(t,"a",(function(){return getDictItem}));var a=n(15),r=n.n(a),i=n(18),o=n(31);function getDictItem(e){return _getDictItem.apply(this,arguments)}function _getDictItem(){return(_getDictItem=Object(i.a)(r.a.mark((function _callee(e){var t;return r.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}throw new Error("字典Code不能为空");case 2:return n.next=4,Object(o.a)("/api/sysDict/getDictItemsByDictCode?dictCode=".concat(e),{"method":"post"});case 4:if(200!==(t=n.sent).resultCode){n.next=7;break}return n.abrupt("return",t.data.map((function(e){return{"text":e.itemText,"value":e.itemValue}})));case 7:return n.abrupt("return",null);case 8:case"end":return n.stop()}}),_callee)})))).apply(this,arguments)}},"601":function(e,t,n){var a=n(21),r=n(753);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={"insert":"head","singleton":!1},o=(a(r,i),r.locals?r.locals:{});e.exports=o},"752":function(e,t,n){"use strict";var a=n(601);n.n(a).a},"753":function(e,t,n){(t=n(19)(!1)).push([e.i,".page-illegal-info {\n  min-height: 100vh;\n  padding-bottom: 2.66667rem;\n}\n.page-illegal-info .bottom {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  background-color: #fff;\n  padding: 0.44444rem 0;\n  -webkit-box-shadow: 0 0 0.08889rem rgba(100, 100, 100, 0.4);\n          box-shadow: 0 0 0.08889rem rgba(100, 100, 100, 0.4);\n}\n.page-illegal-info .bottom .next-btn {\n  position: relative;\n  width: 76%;\n  left: 12%;\n  padding: 0.31111rem 0;\n  color: #fff;\n  background-color: #456fe4;\n  border-radius: 0.71111rem;\n  text-align: center;\n}\n.page-illegal-info .uploader-wrap {\n  background-color: #fff;\n  padding: 0.62222rem;\n  margin-top: 0.44444rem;\n}\n.page-illegal-info .uploader-wrap .uploader-title {\n  margin-bottom: 0.44444rem;\n  font-size: 0.66667rem;\n}\n",""]),e.exports=t},"872":function(e,t,n){"use strict";n.r(t);n(214);var a=n(52),r=n(15),i=n.n(r),o=n(204),c=n(3),l=(n(522),n(520)),s=(n(528),n(529)),u=(n(536),n(541)),p=(n(523),n(515)),f=(n(631),n(646)),d=(n(632),n(647)),h=(n(726),n(861)),m=(n(636),n(691)),v=(n(598),n(59)),b=n(18),y=n(30),T=n(4),g=n(44),w=n(45),k=n.n(w),x=n(32),O=n(637),_=n.n(O),P=n(735),j=n.n(P),N=n(31),C=n(544),I=n(599),S=n(27),M=n(47);function getPhotoOrientation(e){return new Promise((function(t,n){_.a.getData(e,(function(){var n=_.a.getTag(e,"Orientation");t(n)}))}))}function compressImageFile(e){return _compressImageFile.apply(this,arguments)}function _compressImageFile(){return(_compressImageFile=Object(b.a)(i.a.mark((function _callee11(e){var t,n,a,r,o,c,l,s;return i.a.wrap((function _callee11$(i){for(;;)switch(i.prev=i.next){case 0:return t=e.file,n=e.maxWidth,a=void 0===n?1200:n,r=e.maxHeight,o=void 0===r?1200:r,c=e.compressLevel,l=void 0===c?.6:c,i.next=3,getPhotoOrientation(t);case 3:return s=i.sent,i.abrupt("return",new Promise((function(e,n){var r=t,i=new FileReader;i.readAsDataURL(r),i.onload=function(t){var n=new Image;n.src=t.target.result,n.onload=function(){var t=document.createElement("canvas"),r=t.getContext("2d"),i=n.width,c=n.height,u=i,p=c;if(i>a||c>o){var f=Math.max(i/a,c/o);u=i/f,p=c/f}else u=i,p=c;6===s?(t.width=p,t.height=u,r.rotate(90*Math.PI/180),r.drawImage(n,0,-p,u,p)):(t.width=u,t.height=p,r.drawImage(n,0,0,u,p));for(var d=t.toDataURL("image/jpeg",l).split(","),h=d[0].match(/:(.*?);/)[1],m=atob(d[1]),v=m.length,b=new Uint8Array(v);v--;)b[v]=m.charCodeAt(v);var y=new window.File([new Blob([b],{"type":h})],"test.jpeg",{"type":"image/jpeg"});e(y)}}})));case 5:case"end":return i.stop()}}),_callee11)})))).apply(this,arguments)}T.a.use(l.a).use(s.a).use(u.a).use(p.a).use(f.a).use(d.a).use(h.a).use(m.a).use(v.a);var $={"name":"IllegalInfo","data":function data(){return{"offenderName":"","certificateType":"居民身份证","documentNumber":"","violationTypeCode":"","isShowPersonnelTypePicker":!1,"violationTypeOptions":[],"phone":"","trafficModeCode":"","isShowTransportPicker":!1,"trafficModeOptions":[],"carTypeCode":"","isShowVehicleTypePicker":!1,"carTypeOptions":[],"carNumber":"无","images":[]}},"computed":Object(c.a)(Object(c.a)({},Object(g.d)("punishment",["punishInfo"])),{},{"isPersonalType":function isPersonalType(){return this.violationType&&this.violationType.text&&this.violationType.text.indexOf("行人")>-1},"violationType":function violationType(){var e=this;return this.violationTypeOptions.length&&this.violationTypeCode&&x.a.find(this.violationTypeOptions,(function(t){return t.value===e.violationTypeCode}))||{}},"trafficMode":function trafficMode(){var e=this;return this.trafficModeOptions.length&&this.trafficModeCode&&x.a.find(this.trafficModeOptions,(function(t){return t.value===e.trafficModeCode}))||{}},"carType":function carType(){var e=this;return this.carTypeOptions.length&&this.carTypeCode&&x.a.find(this.carTypeOptions,(function(t){return t.value===e.carTypeCode}))||{}}}),"created":function created(){var e=this;return Object(b.a)(i.a.mark((function _callee(){var t,n;return i.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all([e.getPersonnelTypeOptions(),e.getTransportOptions(),e.getVehicleTypeOptions()]);case 2:e.punishInfo.id&&(console.log(e.punishInfo),t=e.punishInfo,t.violationType,t.trafficMode,t.carType,n=Object(o.a)(t,["violationType","trafficMode","carType"]),Object.assign(e.$data,n));case 3:case"end":return a.stop()}}),_callee)})))()},"onShow":function onShow(){var e=localStorage.getItem("checkedCarNumber");e&&(localStorage.removeItem("checkedCarNumber"),this.carNumber=e)},"methods":Object(c.a)(Object(c.a)({},Object(g.c)("punishment",["PUT_PUNISH_INFO"])),{},{"toNextPage":function toNextPage(){var e=this;return Object(b.a)(i.a.mark((function _callee4(){var t,n,a,r,o,l,s,u,p,f,d;return i.a.wrap((function _callee4$(h){for(;;)switch(h.prev=h.next){case 0:return t=e.offenderName,n=e.certificateType,a=e.documentNumber,r=e.phone,o=e.carNumber,l=e.trafficMode,s=e.violationType,u=e.carType,p=e.images,e.PUT_PUNISH_INFO(Object(c.a)(Object(c.a)({},e.punishInfo),{},{"offenderName":t,"certificateType":n,"documentNumber":a,"violationType":s,"phone":r,"trafficMode":l,"carType":u,"carNumber":o,"images":p})),h.next=4,Promise.all(p.filter((function(e){return!e.url})).map((function(e){return compressImageFile({"file":e.file,"maxWidth":1e3,"compressLevel":.6})})));case 4:return f=h.sent,d=f.map(function(){var e=Object(b.a)(i.a.mark((function _callee3(e){var t,n;return i.a.wrap((function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:return(t=new FormData).append("file",e),a.next=4,Object(M.a)();case 4:return n=a.sent,a.abrupt("return",Object(b.a)(i.a.mark((function _callee2(){var e;return i.a.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,j()({"url":"".concat(S.a,"/api/tFileInfo/fileUpload"),"headers":{"Authorization":n},"method":"post","data":t});case 2:return e=a.sent,a.abrupt("return",e);case 4:case"end":return a.stop()}}),_callee2)})))());case 6:case"end":return a.stop()}}),_callee3)})));return function(t){return e.apply(this,arguments)}}()),h.next=8,Promise.all(d);case 8:return h.sent,h.abrupt("return");case 11:case"end":return h.stop()}}),_callee4)})))()},"afterRead":function afterRead(e){return Object(b.a)(i.a.mark((function _callee5(){return i.a.wrap((function _callee5$(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),_callee5)})))()},"onPersonnelTypePickerConfirm":function onPersonnelTypePickerConfirm(e){var t=this;this.violationTypeCode=e.value,this.isShowPersonnelTypePicker=!1,setTimeout((function(){t.violationType&&t.violationType.text&&t.violationType.text.indexOf("行人")>-1&&(t.carTypeCode="",t.carNumber="无")}),200)},"onTransportPickerConfirm":function onTransportPickerConfirm(e){this.trafficModeCode=e.value,this.isShowTransportPicker=!1},"onVehicleTypePickerConfirm":function onVehicleTypePickerConfirm(e){this.carTypeCode=e.value,this.isShowVehicleTypePicker=!1},"valid":function valid(){var e=!0,t=this.offenderName,n=(this.certificateType,this.documentNumber),a=this.phone,r=this.carNumber,i=this.trafficMode,o=this.violationType,c=this.carType,l=[{"value":t,"txt":"请输入姓名"},{"value":n,"txt":"请输入证件号码"},{"value":o,"txt":"请选择人员分类"},{"value":i,"txt":"请选择交通方式"}];this.isPersonalType||(l=l.concat([{"value":c,"txt":"请选择车辆分类"}]));for(var s=0;s<l.length;s++){var u=l[s];if(Object(C.a)(u.value)){Object(y.showToast)({"title":u.txt,"icon":"none"}),e=!1;break}}return!!e&&(Object(C.c)(n)?a&&!Object(C.d)(a)?(Object(y.showToast)({"title":"输入的联系电话有误，请检查","icon":"none"}),!1):!(!this.isPersonalType&&r&&"无"!==r&&!Object(C.b)(r))||void Object(y.showToast)({"title":"输入的车牌号有误，请检查","icon":"none"}):(Object(y.showToast)({"title":"输入的证件号码有误，请检查","icon":"none"}),!1))},"getVehicleTypeOptions":function getVehicleTypeOptions(){var e=this;return Object(b.a)(i.a.mark((function _callee6(){return i.a.wrap((function _callee6$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(I.a)("vehicle_type").then((function(t){null!=t&&(e.carTypeOptions=t)}));case 2:case"end":return t.stop()}}),_callee6)})))()},"getTransportOptions":function getTransportOptions(){var e=this;return Object(b.a)(i.a.mark((function _callee7(){return i.a.wrap((function _callee7$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(I.a)("transport").then((function(t){null!=t&&(e.trafficModeOptions=t)}));case 2:case"end":return t.stop()}}),_callee7)})))()},"getPersonnelTypeOptions":function getPersonnelTypeOptions(){var e=this;return Object(b.a)(i.a.mark((function _callee8(){return i.a.wrap((function _callee8$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(I.a)("personnel_type").then((function(t){null!=t&&(e.violationTypeOptions=t)}));case 2:case"end":return t.stop()}}),_callee8)})))()},"checkIdentity":function checkIdentity(){var e=this;return Object(b.a)(i.a.mark((function _callee9(){var t,n,r,o,c,l,s;return i.a.wrap((function _callee9$(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.offenderName,n=e.documentNumber,r=e.certificateType,!(t.length<1)){i.next=4;break}return Object(y.showToast)({"title":"请输入姓名","icon":"none"}),i.abrupt("return",!1);case 4:if(!(n.length<1)){i.next=7;break}return Object(y.showToast)({"title":"请输入证件号码","icon":"none"}),i.abrupt("return",!1);case 7:if(Object(C.c)(n)){i.next=10;break}return Object(y.showToast)({"title":"输入的证件号码有误，请检查","icon":"none"}),i.abrupt("return",!1);case 10:return Object(y.showLoading)({"title":"核查中...","mask":!0}),o={"identityNumber":n},i.next=14,Object(N.a)("/api/identity/identityVerify?".concat(k.a.stringify(o)),{"method":"post"});case 14:if(c=i.sent,Object(y.hideToast)(),Object(y.hideLoading)(),200===c.resultCode){for(s in l=[],c.data)l.push({"libName":s,"result":c.data[s]});y.default.navigateTo({"url":"/pages/identityCheck/index?".concat(k.a.stringify({"name":t,"certificateType":r,"idcard":n,"checkResults":JSON.stringify(l)}))})}else Object(a.a)({"type":"danger","duration":2e3,"message":"可能由于网络或服务器繁忙，请稍后重试~"});case 18:case"end":return i.stop()}}),_callee9)})))()},"checkCarNumber":function checkCarNumber(){var e=this;return Object(b.a)(i.a.mark((function _callee10(){var t,n,a,r;return i.a.wrap((function _callee10$(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.carNumber,n=e.documentNumber,a=e.offenderName,r="",r=t&&"无"!==t?t:n||a,t&&"无"!==t||n||a){i.next=6;break}return Object(y.showToast)({"title":"请填写【车牌号】【姓名】【身份证】至少一样！","icon":"none"}),i.abrupt("return");case 6:y.default.navigateTo({"url":"/pages/search/index?keyword=".concat(r)});case 7:case"end":return i.stop()}}),_callee10)})))()}})},V=(n(752),n(512)),D=Object(V.a)($,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{"staticClass":"page page-illegal-info"},[n("div",{"staticClass":"main-content"},[n("van-cell-group",{"attrs":{"title":"人员基本信息"}},[n("van-field",{"attrs":{"required":"","clearable":"","label":"姓名","placeholder":"请输入姓名"},"model":{"value":e.offenderName,"callback":function(t){e.offenderName=t},"expression":"offenderName"}}),e._v(" "),n("van-field",{"attrs":{"required":"","clearable":"","label":"身份证号","placeholder":"请输入身份证号"},"model":{"value":e.documentNumber,"callback":function(t){e.documentNumber=t},"expression":"documentNumber"}},[n("van-button",{"attrs":{"slot":"button","size":"small","type":"info","plain":""},"on":{"click":e.checkIdentity},"slot":"button"},[e._v("\n          身份核查\n        ")])],1)],1),e._v(" "),n("van-cell-group",{"attrs":{"title":"违法基本信息"}},[n("van-field",{"attrs":{"required":"","clearable":"","label":"人员分类","placeholder":"请选择人员分类","readonly":""},"on":{"click":function(t){e.isShowPersonnelTypePicker=!0}},"model":{"value":e.violationType.text,"callback":function(t){e.$set(e.violationType,"text",t)},"expression":"violationType.text"}}),e._v(" "),n("van-field",{"attrs":{"clearable":"","label":"联系电话","placeholder":"请输入联系电话"},"model":{"value":e.phone,"callback":function(t){e.phone=t},"expression":"phone"}}),e._v(" "),n("van-field",{"attrs":{"required":"","clearable":"","label":"交通方式","placeholder":"请选择交通方式","readonly":""},"on":{"click":function(t){e.isShowTransportPicker=!0}},"model":{"value":e.trafficMode.text,"callback":function(t){e.$set(e.trafficMode,"text",t)},"expression":"trafficMode.text"}}),e._v(" "),e.isPersonalType?e._e():n("van-field",{"attrs":{"required":"","clearable":"","label":"车辆分类","placeholder":"请选择车辆分类","readonly":""},"on":{"click":function(t){e.isShowVehicleTypePicker=!0}},"model":{"value":e.carType.text,"callback":function(t){e.$set(e.carType,"text",t)},"expression":"carType.text"}}),e._v(" "),e.isPersonalType?e._e():n("van-field",{"attrs":{"clearable":"","label":"车牌号码","placeholder":"请输入车牌号码"},"model":{"value":e.carNumber,"callback":function(t){e.carNumber=t},"expression":"carNumber"}},[n("van-button",{"attrs":{"slot":"button","size":"small","type":"info","plain":""},"on":{"click":e.checkCarNumber},"slot":"button"},[e._v("\n          车辆核查\n        ")])],1)],1)],1),e._v(" "),n("div",{"staticClass":"uploader-wrap"},[n("div",{"staticClass":"uploader-title"},[e._v("现场图片")]),e._v(" "),n("van-uploader",{"attrs":{"after-read":e.afterRead,"max-count":3,"preview-size":"106px"},"model":{"value":e.images,"callback":function(t){e.images=t},"expression":"images"}})],1),e._v(" "),n("div",{"staticClass":"bottom"},[n("div",{"staticClass":"next-btn","on":{"click":e.toNextPage}},[e._v("下一步（违法处罚）")])]),e._v(" "),n("van-popup",{"attrs":{"position":"bottom"},"model":{"value":e.isShowPersonnelTypePicker,"callback":function(t){e.isShowPersonnelTypePicker=t},"expression":"isShowPersonnelTypePicker"}},[n("van-picker",{"attrs":{"show-toolbar":"","columns":e.violationTypeOptions},"on":{"cancel":function(t){e.isShowPersonnelTypePicker=!1},"confirm":e.onPersonnelTypePickerConfirm}})],1),e._v(" "),n("van-popup",{"attrs":{"position":"bottom"},"model":{"value":e.isShowTransportPicker,"callback":function(t){e.isShowTransportPicker=t},"expression":"isShowTransportPicker"}},[n("van-picker",{"attrs":{"show-toolbar":"","columns":e.trafficModeOptions},"on":{"cancel":function(t){e.isShowTransportPicker=!1},"confirm":e.onTransportPickerConfirm}})],1),e._v(" "),n("van-popup",{"attrs":{"position":"bottom"},"model":{"value":e.isShowVehicleTypePicker,"callback":function(t){e.isShowVehicleTypePicker=t},"expression":"isShowVehicleTypePicker"}},[n("van-picker",{"attrs":{"show-toolbar":"","columns":e.carTypeOptions},"on":{"cancel":function(t){e.isShowVehicleTypePicker=!1},"confirm":e.onVehicleTypePickerConfirm}})],1)],1)}),[],!1,null,null,null);t.default=D.exports}}]);